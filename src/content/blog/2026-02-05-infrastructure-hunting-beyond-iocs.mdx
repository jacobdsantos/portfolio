---
title: "Infrastructure Hunting Beyond IOCs"
date: "2026-02-05"
excerpt: "Moving up the Pyramid of Pain — from hash-based detection to hunting adversary infrastructure through default configurations, SSL certificates, and response fingerprints."
tags: ["threat-intelligence", "security", "tools"]
featured: false
draft: false
---

## Why Infrastructure Matters

Most threat hunting starts at the bottom of the Pyramid of Pain — hashes, IP addresses, domain names. These are easy to detect but trivial for attackers to change. A ransomware group can recompile their binary and every hash-based detection becomes useless overnight.

Infrastructure sits higher on the pyramid. C2 servers, staging hosts, and distribution nodes take more effort to set up and maintain. If you can identify the patterns an adversary uses to deploy their infrastructure, you can find new instances before they are used in attacks.

Our team started expanding into infrastructure hunting after realizing that file-based detection, while necessary, only catches what has already been used. Finding the infrastructure catches what is being prepared.

## The Approach

The general pattern looks like this: take a known piece of adversary infrastructure, identify what makes it unique, then search for those characteristics at scale.

For one C2 framework, that meant setting up the tool from source and examining what the default deployment looks like. Every web server has fingerprints — the 404 page content, response headers, default ports, SSL certificate patterns. Most operators do not bother changing these defaults.

Armed with those fingerprints, you can query platforms like FOFA, Shodan, or Censys for matching servers. Not every match is malicious — you need to verify — but the hit rate can be surprisingly high.

## A Practical Example

For one APT campaign, the pivot started differently. After analyzing the malware stages and writing YARA rules for the initial delivery and anti-VM components, I monitored VirusTotal for new matches. When a low-detection sample appeared, I used the known C2 domain to pivot through URLScan — specifically looking at the DOM content of scanned pages. That led to identifying structural patterns in how the group set up their infrastructure, which I then hunted for on FOFA to find additional C2 servers that had not been reported.

The takeaway was that infrastructure hunting is not a single technique. It is a chain: malware analysis gives you indicators, indicators give you infrastructure patterns, patterns give you new infrastructure, and new infrastructure gives you early warning.

## Tools for the Job

I built automation around parts of this workflow — scripts that query infrastructure search engines, correlate SSL certificates, track newly registered domains, and flag potential C2 servers based on known fingerprints. Some of this feeds into daily monitoring dashboards that the team uses.

The tooling is practical, not fancy. Most of it is Python scripts that run on a schedule, output CSVs, and flag anomalies. The value is not in the code but in knowing what patterns to look for — and that only comes from doing the analysis manually first.
