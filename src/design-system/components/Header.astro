---
const navLinks = [
  { label: 'Research', href: '/research' },
  { label: 'Tools', href: '/tools' },
  { label: 'Blog', href: '/blog' },
  { label: 'Speaking', href: '/speaking' },
  { label: 'About', href: '/about' },
  { label: 'Contact', href: '/contact' },
];

const currentPath = Astro.url.pathname;

const isActive = (href: string) => {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
};
---

<header class="sticky top-0 z-30 w-full border-b border-white/[0.04]" style="background: linear-gradient(135deg, rgba(8,9,14,0.75) 0%, rgba(14,16,22,0.7) 100%); backdrop-filter: blur(40px) saturate(1.8); -webkit-backdrop-filter: blur(40px) saturate(1.8);">
  <div class="max-w-[1200px] mx-auto px-4 md:px-6 lg:px-10">
    <div class="flex items-center justify-between h-14">
      <!-- Logo / site name -->
      <a href="/" class="flex items-center gap-2.5 group shrink-0">
        <div class="relative w-8 h-8 rounded-lg bg-gradient-to-br from-accent-primary/25 via-accent-tertiary/15 to-accent-secondary/25 border border-accent-primary/20 flex items-center justify-center transition-all duration-300 group-hover:border-accent-primary/40 group-hover:shadow-[0_0_15px_-3px_rgba(0,223,162,0.2)]">
          <span class="text-sm font-bold bg-gradient-to-br from-accent-primary to-accent-tertiary bg-clip-text text-transparent font-mono">JS</span>
        </div>
        <span class="text-text-primary font-semibold text-sm tracking-tight hidden sm:inline transition-colors group-hover:text-accent-primary font-display">Jacob Santos</span>
      </a>

      <!-- Desktop navigation -->
      <nav class="hidden md:flex items-center gap-0.5" aria-label="Main navigation">
        {navLinks.map(link => (
          <a
            href={link.href}
            class:list={[
              'relative px-3.5 py-2 text-sm font-medium rounded-xl transition-all duration-200',
              isActive(link.href)
                ? 'text-accent-primary bg-accent-primary/[0.08] border border-accent-primary/15'
                : 'text-text-muted hover:text-text-primary hover:bg-white/[0.03] border border-transparent',
            ]}
            aria-current={isActive(link.href) ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
      </nav>

      <!-- Mobile hamburger toggle -->
      <input type="checkbox" id="mobile-menu-toggle" class="hidden peer" aria-label="Toggle navigation menu" />
      <label
        for="mobile-menu-toggle"
        class="md:hidden flex items-center justify-center w-10 h-10 rounded-xl text-text-muted hover:text-text-primary hover:bg-white/[0.04] transition-all cursor-pointer"
        aria-label="Open navigation menu"
      >
        <!-- Hamburger icon (shown when unchecked) -->
        <svg class="w-5 h-5 peer-checked:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </label>
    </div>
  </div>

  <!-- Mobile menu (CSS-only toggle via peer) -->
  <div class="hidden peer-checked:block md:hidden border-t border-white/[0.04] bg-bg-primary/95 backdrop-blur-2xl">
    <nav class="px-4 py-3 space-y-1" aria-label="Mobile navigation">
      {navLinks.map(link => (
        <a
          href={link.href}
          class:list={[
            'block px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200',
            isActive(link.href)
              ? 'text-accent-primary bg-accent-primary/[0.08] border border-accent-primary/15'
              : 'text-text-muted hover:text-text-primary hover:bg-white/[0.04] border border-transparent',
          ]}
          aria-current={isActive(link.href) ? 'page' : undefined}
        >
          {link.label}
        </a>
      ))}

      <!-- Mobile sidebar profile (condensed) -->
      <div class="sep"></div>
      <div class="flex items-center gap-3 px-4 py-2.5">
        <div class="w-10 h-10 rounded-xl bg-bg-secondary border border-accent-primary/20 flex items-center justify-center">
          <span class="text-sm font-bold bg-gradient-to-br from-accent-primary via-accent-tertiary to-accent-secondary bg-clip-text text-transparent font-mono">JS</span>
        </div>
        <div>
          <p class="text-text-primary text-sm font-semibold font-display">Jacob Santos</p>
          <p class="text-text-muted text-[10px] font-mono">Sr. Threat Researcher</p>
        </div>
      </div>
      <div class="flex items-center gap-3 px-4 py-1.5">
        <a href="mailto:jacobsantos.d@gmail.com" class="text-text-muted hover:text-accent-primary transition-colors" title="Email">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"/></svg>
        </a>
        <a href="https://www.linkedin.com/in/jacob-santos-046313198/" target="_blank" rel="noopener" class="text-text-muted hover:text-accent-primary transition-colors" title="LinkedIn">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        </a>
        <a href="https://github.com/jacobdsantos" target="_blank" rel="noopener" class="text-text-muted hover:text-accent-primary transition-colors" title="GitHub">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
        </a>
      </div>
      <a href="/resume" class="flex items-center justify-center gap-2 mx-4 mt-2 mb-1 py-2.5 rounded-xl bg-accent-primary/[0.08] border border-accent-primary/15 text-accent-primary text-xs font-medium hover:bg-accent-primary/15 transition-all">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
        </svg>
        View Resume
      </a>
    </nav>
  </div>
</header>

<style>
  /* Make the mobile menu toggle work purely with CSS via the checkbox peer selector */
  #mobile-menu-toggle:checked ~ div {
    display: block;
  }
  #mobile-menu-toggle:not(:checked) ~ div {
    display: none;
  }
  /* Swap hamburger to X when checked */
  #mobile-menu-toggle:checked + label svg {
    display: none;
  }
  #mobile-menu-toggle:checked + label::after {
    content: '';
    display: block;
    width: 20px;
    height: 20px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%238b949e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M6 18L18 6M6 6l12 12'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
  }
  /* On md+ screens, always hide mobile menu and checkbox effects */
  @media (min-width: 768px) {
    #mobile-menu-toggle ~ div {
      display: none !important;
    }
  }
</style>
