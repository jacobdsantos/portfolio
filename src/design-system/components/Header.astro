---
const navLinks = [
  { label: 'Research', href: '/research' },
  { label: 'Tools', href: '/tools' },
  { label: 'Blog', href: '/blog' },
  { label: 'Speaking', href: '/speaking' },
  { label: 'About', href: '/about' },
  { label: 'Contact', href: '/contact' },
];

const currentPath = Astro.url.pathname;

const isActive = (href: string) => {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
};
---

<header class="sticky top-0 z-30 w-full border-b border-white/[0.04]" style="background: linear-gradient(135deg, rgba(8,9,14,0.75) 0%, rgba(14,16,22,0.7) 100%); backdrop-filter: blur(40px) saturate(1.8); -webkit-backdrop-filter: blur(40px) saturate(1.8);">
  <div class="max-w-[1200px] mx-auto px-4 md:px-6 lg:px-10">
    <div class="flex items-center justify-between h-14">
      <!-- Logo / site name -->
      <a href="/" class="flex items-center gap-2.5 group shrink-0">
        <div class="relative w-8 h-8 rounded-lg bg-gradient-to-br from-accent-primary/25 via-accent-tertiary/15 to-accent-secondary/25 border border-accent-primary/20 flex items-center justify-center transition-all duration-300 group-hover:border-accent-primary/40 group-hover:shadow-[0_0_15px_-3px_rgba(240,166,58,0.2)]">
          <span class="text-sm font-bold bg-gradient-to-br from-accent-primary to-accent-tertiary bg-clip-text text-transparent font-mono">JS</span>
        </div>
        <span class="text-text-primary font-semibold text-sm tracking-tight hidden sm:inline transition-colors group-hover:text-accent-primary font-display">Jacob Santos</span>
      </a>

      <!-- Desktop navigation -->
      <nav class="hidden md:flex items-center gap-0.5" aria-label="Main navigation">
        {navLinks.map(link => (
          <a
            href={link.href}
            class:list={[
              'relative px-3.5 py-2 text-sm font-medium rounded-xl transition-all duration-200',
              isActive(link.href)
                ? 'text-accent-primary bg-accent-primary/[0.08] border border-accent-primary/15'
                : 'text-text-muted hover:text-text-primary hover:bg-white/[0.03] border border-transparent',
            ]}
            aria-current={isActive(link.href) ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
      </nav>

      <!-- Mobile hamburger toggle -->
      <input type="checkbox" id="mobile-menu-toggle" class="hidden peer" aria-label="Toggle navigation menu" />
      <label
        for="mobile-menu-toggle"
        class="md:hidden flex items-center justify-center w-10 h-10 rounded-xl text-text-muted hover:text-text-primary hover:bg-white/[0.04] transition-all cursor-pointer"
        aria-label="Open navigation menu"
      >
        <!-- Hamburger icon (shown when unchecked) -->
        <svg class="w-5 h-5 peer-checked:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </label>
    </div>
  </div>

  <!-- Mobile menu (CSS-only toggle via peer) -->
  <div class="hidden peer-checked:block md:hidden border-t border-white/[0.04] bg-bg-primary/95 backdrop-blur-2xl">
    <nav class="px-4 py-3 space-y-1" aria-label="Mobile navigation">
      {navLinks.map(link => (
        <a
          href={link.href}
          class:list={[
            'block px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200',
            isActive(link.href)
              ? 'text-accent-primary bg-accent-primary/[0.08] border border-accent-primary/15'
              : 'text-text-muted hover:text-text-primary hover:bg-white/[0.04] border border-transparent',
          ]}
          aria-current={isActive(link.href) ? 'page' : undefined}
        >
          {link.label}
        </a>
      ))}

      <!-- Mobile sidebar profile (condensed) -->
      <div class="sep"></div>
      <div class="flex items-center gap-3 px-4 py-2.5">
        <img src="/images/profile.jpg" alt="Jacob Santos" class="w-10 h-10 rounded-xl object-cover object-top border border-white/[0.08]" loading="lazy" />
        <div>
          <p class="text-text-primary text-sm font-semibold font-display">Jacob Santos</p>
          <p class="text-text-muted text-[10px] font-mono">Sr. Threat Researcher</p>
        </div>
      </div>
    </nav>
  </div>
</header>

<style>
  /* Make the mobile menu toggle work purely with CSS via the checkbox peer selector */
  #mobile-menu-toggle:checked ~ div {
    display: block;
  }
  #mobile-menu-toggle:not(:checked) ~ div {
    display: none;
  }
  /* Swap hamburger to X when checked */
  #mobile-menu-toggle:checked + label svg {
    display: none;
  }
  #mobile-menu-toggle:checked + label::after {
    content: '';
    display: block;
    width: 20px;
    height: 20px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%238b949e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M6 18L18 6M6 6l12 12'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
  }
  /* On md+ screens, always hide mobile menu and checkbox effects */
  @media (min-width: 768px) {
    #mobile-menu-toggle ~ div {
      display: none !important;
    }
  }
</style>
