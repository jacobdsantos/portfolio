---
import AppShell from '../design-system/components/AppShell.astro';
import Carousel from '../design-system/components/Carousel.astro';
import { getCollection } from 'astro:content';

const allResearch = await getCollection('research');
const allTools = await getCollection('tools');
const allSpeaking = await getCollection('speaking');

const researchCount = allResearch.length;
const toolsCount = allTools.length;
const speakingCount = allSpeaking.length;

// Featured research: top 4 by order (lowest order = highest priority)
const featuredResearch = allResearch
  .sort((a, b) => (a.data.order ?? 99) - (b.data.order ?? 99))
  .slice(0, 4)
  .map(entry => ({
    title: entry.data.title,
    description: entry.data.description,
    href: entry.data.url,
    tags: entry.data.tags,
  }));

// Latest research (most recent 3 by order)
const latestResearch = allResearch
  .sort((a, b) => (a.data.order ?? 99) - (b.data.order ?? 99))
  .slice(0, 3)
  .map(entry => entry.data);

const tagColors: Record<string, string> = {
  'Ransomware': 'tag-red', 'BYOVD': 'tag-amber', 'Defense Evasion': 'tag-amber',
  'Cross-Platform': 'tag-cyan', 'LockBit': 'tag-red', 'APT Crossover': 'tag-purple',
  'DLL Sideloading': 'tag-amber', 'APT': 'tag-purple', 'China-Nexus': 'tag-purple',
  'Espionage': 'tag-purple', 'Taiwan': 'tag-cyan', 'RAT': 'tag-red',
  'Social Engineering': 'tag-amber', 'Red Team Tools': 'tag-amber',
  'EDR Evasion': 'tag-red', 'WFP': 'tag-cyan', 'GPO Abuse': 'tag-amber', 'Safe Mode': 'tag-amber',
};

const gradients = [
  'from-red-500/30 via-orange-500/20 to-yellow-500/10',
  'from-violet-500/30 via-purple-500/20 to-fuchsia-500/10',
  'from-emerald-500/30 via-teal-500/20 to-cyan-500/10',
];

const whatIDo = [
  {
    title: 'Threat Research',
    color: 'from-red-500/20 to-orange-500/10',
    accent: 'text-red-400 bg-red-500/10 border-red-500/15',
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/></svg>`,
    description: 'Deep-dive analysis of ransomware families, APT campaigns, and adversary tooling. Published on the company research blog.',
    link: '/research',
  },
  {
    title: 'Security Automation',
    color: 'from-emerald-500/20 to-teal-500/10',
    accent: 'text-emerald-400 bg-emerald-500/10 border-emerald-500/15',
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"/></svg>`,
    description: 'Building AI-powered tools that multiply team capability -- inquiry pipelines, threat intel platforms, MCP servers, and report generators.',
    link: '/tools',
  },
  {
    title: 'Intelligence Dissemination',
    color: 'from-violet-500/20 to-purple-500/10',
    accent: 'text-violet-400 bg-violet-500/10 border-violet-500/15',
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582"/></svg>`,
    description: 'Delivering advanced threat defense workshops for multinational participants, government agencies, and enterprises across multiple countries.',
    link: '/speaking',
  },
  {
    title: 'Tool Development',
    color: 'from-cyan-500/20 to-blue-500/10',
    accent: 'text-cyan-400 bg-cyan-500/10 border-cyan-500/15',
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0021 18V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v12a2.25 2.25 0 002.25 2.25z"/></svg>`,
    description: 'Production tools used daily by the team -- MCP servers, AI pipelines, desktop applications, and Confluence integrations.',
    link: '/tools',
  },
];

const personJsonLd = {
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Jacob Santos",
  "jobTitle": "Senior Threat Researcher",
  "worksFor": {
    "@type": "Organization",
    "name": "Trend Micro"
  },
  "url": "https://jacobsantos.pages.dev",
  "sameAs": [
    "https://github.com/jacobdsantos",
    "https://www.linkedin.com/in/jacob-santos-046313198/"
  ],
  "knowsAbout": [
    "Ransomware Analysis",
    "Advanced Persistent Threats",
    "Threat Intelligence",
    "MITRE ATT&CK",
    "Malware Analysis",
    "Security Automation"
  ],
  "description": "Senior threat researcher specializing in ransomware analysis, APT tracking, and security automation."
};
---

<AppShell jsonLd={personJsonLd}>

  <!-- Hero Section -->
  <section class="content-card mb-6 relative overflow-hidden">
    <!-- Decorative gradient orb -->
    <div class="absolute -top-20 -right-20 w-60 h-60 bg-gradient-to-br from-accent-primary/[0.08] to-accent-secondary/[0.04] rounded-full blur-3xl pointer-events-none"></div>
    <div class="absolute -bottom-16 -left-16 w-40 h-40 bg-gradient-to-tr from-accent-tertiary/[0.04] to-transparent rounded-full blur-3xl pointer-events-none"></div>

    <div class="relative flex flex-col md:flex-row md:items-center md:justify-between gap-6">
      <div class="flex-1">
        <div class="animate-fade-up inline-flex items-center gap-2 mb-4 px-3 py-1 rounded-lg bg-accent-primary/[0.06] border border-accent-primary/10 text-xs font-mono text-accent-primary">
          <span class="relative flex h-1.5 w-1.5">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-accent-primary opacity-75"></span>
            <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-accent-primary"></span>
          </span>
          Available for speaking & collaboration
        </div>
        <h1 class="animate-fade-up-delay-1 text-3xl md:text-4xl font-semibold text-text-primary tracking-tight mb-3 font-display" style="letter-spacing: -0.03em;">
          Hi, I'm <span class="gradient-text-animated">Jacob Santos</span>
        </h1>
        <p class="animate-fade-up-delay-2 text-text-secondary text-base md:text-lg leading-relaxed max-w-xl">
          Senior threat researcher who <span class="text-accent-primary font-medium">hunts</span> for emerging threats,
          <span class="text-accent-tertiary font-medium">builds</span> operational security tools, and
          <span class="text-accent-secondary font-medium">shares</span> findings through research and workshops.
        </p>
        <div class="animate-fade-up-delay-3 flex flex-wrap gap-3 mt-6">
          <a href="/about" class="group inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-accent-primary text-bg-primary font-semibold text-sm transition-all duration-300 hover:shadow-[0_0_30px_-5px_rgba(240,166,58,0.5)] hover:scale-[1.02]">
            <svg class="w-4 h-4 transition-transform duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
            </svg>
            Learn More
          </a>
          <a href="/resume" class="group inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-bg-surface border border-white/[0.06] text-text-secondary text-sm font-medium hover:text-text-primary hover:border-white/[0.12] hover:bg-bg-hover transition-all duration-300">
            <svg class="w-4 h-4 transition-transform duration-300 group-hover:-translate-y-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
            </svg>
            View Resume
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Stats Bar -->
  <section class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6" data-reveal>
    <div class="stat-card group" style="--stat-glow: rgba(240, 166, 58, 0.2);" data-reveal-delay="1">
      <div class="text-2xl font-bold text-accent-primary font-mono mb-0.5">17</div>
      <div class="text-text-muted text-[9px] uppercase tracking-widest">Blog Articles</div>
    </div>
    <div class="stat-card group" style="--stat-glow: rgba(139, 124, 247, 0.15);" data-reveal-delay="2">
      <div class="text-2xl font-bold text-accent-secondary font-mono mb-0.5">14</div>
      <div class="text-text-muted text-[9px] uppercase tracking-widest">Microstories</div>
    </div>
    <div class="stat-card group" style="--stat-glow: rgba(76, 201, 240, 0.15);" data-reveal-delay="3">
      <div class="text-2xl font-bold text-accent-tertiary font-mono mb-0.5">10+</div>
      <div class="text-text-muted text-[9px] uppercase tracking-widest">Tools Built</div>
    </div>
    <div class="stat-card group" style="--stat-glow: rgba(255, 107, 107, 0.15);" data-reveal-delay="4">
      <div class="text-2xl font-bold text-accent-danger font-mono mb-0.5">10+</div>
      <div class="text-text-muted text-[9px] uppercase tracking-widest">Talks & Training</div>
    </div>
  </section>

  <!-- Featured Research Carousel -->
  <section class="content-card mb-6" data-reveal>
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="section-title !mb-0">Featured Research</h2>
        <p class="text-text-muted text-xs mt-1">Latest published threat analysis and intelligence</p>
      </div>
      <a href="/research" class="inline-flex items-center gap-1.5 text-accent-primary text-xs font-medium hover:underline shrink-0 group">
        View all
        <svg class="w-3 h-3 transition-transform duration-200 group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
      </a>
    </div>
    <Carousel items={featuredResearch} />
  </section>

  <!-- What I Do Grid -->
  <section class="content-card mb-6" data-reveal>
    <h2 class="section-title">What I Do</h2>
    <p class="section-subtitle">Combining threat research with automation and intelligence dissemination.</p>
    <div class="grid sm:grid-cols-2 gap-3">
      {whatIDo.map((item, idx) => (
        <a href={item.link} class="card !p-4 group block" data-reveal data-reveal-delay={String(idx + 1)}>
          <div class="flex items-start gap-3">
            <div class={`w-10 h-10 rounded-xl border flex items-center justify-center shrink-0 ${item.accent} transition-all duration-300 group-hover:scale-110 group-hover:shadow-[0_0_15px_-3px_currentColor]`} set:html={item.icon} />
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2">
                <h3 class="text-text-primary font-semibold text-sm mb-1 group-hover:text-accent-primary transition-colors">{item.title}</h3>
                <svg class="w-3 h-3 text-text-muted/30 shrink-0 -mt-0.5 transition-all duration-300 group-hover:text-accent-primary/50 group-hover:translate-x-0.5 group-hover:-translate-y-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"/></svg>
              </div>
              <p class="text-text-muted text-xs leading-relaxed">{item.description}</p>
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>

  <!-- Latest Research Cards -->
  <section class="content-card mb-6" data-reveal>
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="section-title !mb-0">Recent Activity</h2>
        <p class="text-text-muted text-xs mt-1">Latest published research and threat analysis</p>
      </div>
      <a href="/research" class="inline-flex items-center gap-1.5 text-accent-primary text-xs font-medium hover:underline shrink-0 group">
        All research
        <svg class="w-3 h-3 transition-transform duration-200 group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
      </a>
    </div>
    <div class="space-y-3">
      {latestResearch.map((article, idx) => (
        <a href={article.url} target="_blank" rel="noopener" class="card !p-0 overflow-hidden group block" data-reveal data-reveal-delay={String(idx + 1)}>
          <div class={`h-1 bg-gradient-to-r ${gradients[idx % gradients.length]}`}></div>
          <div class="p-4">
            <div class="flex items-start gap-4">
              <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between gap-2 mb-1">
                  <h3 class="text-text-primary font-semibold text-sm group-hover:text-accent-primary transition-colors line-clamp-2">{article.title}</h3>
                  <span class="text-text-muted text-[10px] font-mono shrink-0">{article.date}</span>
                </div>
                <p class="text-text-muted text-xs leading-relaxed mb-2 line-clamp-2">{article.description}</p>
                <div class="flex flex-wrap gap-1">
                  {article.tags.slice(0, 3).map(tag => (
                    <span class={`${tagColors[tag] || 'tag-green'} !text-[8px]`}>{tag}</span>
                  ))}
                </div>
              </div>
              <div class="shrink-0 mt-1 opacity-0 group-hover:opacity-100 transition-all duration-300 group-hover:translate-x-0">
                <svg class="w-4 h-4 text-accent-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25" />
                </svg>
              </div>
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>

  <!-- CTA Section -->
  <section class="relative rounded-2xl overflow-hidden border border-white/[0.06] p-6 md:p-8 text-center" data-reveal>
    <!-- Background layers -->
    <div class="absolute inset-0 bg-gradient-to-br from-accent-primary/[0.04] via-bg-surface/80 to-accent-secondary/[0.04]"></div>
    <div class="absolute inset-0 opacity-[0.02]" style="background-image: linear-gradient(rgba(255,255,255,0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.5) 1px, transparent 1px); background-size: 24px 24px;"></div>
    <div class="absolute inset-0" style="box-shadow: inset 0 1px 0 rgba(255,255,255,0.04), 0 20px 50px -12px rgba(0,0,0,0.5);"></div>

    <div class="relative">
      <h2 class="text-xl font-semibold text-text-primary mb-2 tracking-tight font-display">Interested in working together?</h2>
      <p class="text-text-secondary text-sm max-w-md mx-auto mb-5">
        I'm open to speaking engagements, research collaboration, and workshop opportunities.
      </p>
      <div class="flex flex-wrap items-center justify-center gap-3">
        <a href="/contact" class="group inline-flex items-center gap-2 px-6 py-2.5 rounded-xl bg-accent-primary text-bg-primary font-semibold text-sm transition-all duration-300 hover:shadow-[0_0_30px_-5px_rgba(240,166,58,0.5)] hover:scale-[1.02]">
          <svg class="w-4 h-4 transition-transform duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
          </svg>
          Get in Touch
        </a>
        <a href="/speaking" class="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-bg-surface border border-white/[0.06] text-text-secondary text-sm font-medium hover:text-text-primary hover:border-white/[0.12] transition-all duration-300">
          Speaking Engagements
        </a>
      </div>
    </div>
  </section>

</AppShell>
